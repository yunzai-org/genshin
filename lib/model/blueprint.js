import t from"./base.js";import{MysInfo as e,MysApi as s}from"yunzai-mys";class i extends t{constructor(t){super(t)}model="blueprint";checkMsg="设置尘歌壶模数有误\n指令：#尘歌壶模数\n示例：#尘歌壶模数123456\n参数为模数id(10-15位数字)";async get(t){let i=await e.getUid(this.e,!1);if(!i)return!1;let a=await e.checkUidBing(i,this.e);if(!a)return await this.e.reply(e.tips),!1;this.mysApi=new s(a.uid,a.ck,{log:!0});let r=await this.mysApi.getData("blueprint",{share_code:t,headers:"https://webstatic.mihoyo.com/ys/event/e20200923adopt_calculator/index.html?bbs_presentation_style=fullscreen&bbs_auth_required=true&mys_source=GameRecord"}),n=await this.getBody(r);if(!n)return!1;let o=await this.computes(n);return!!o&&{saveId:i,uid:i,share_code:t[0],blueprint:r,computes:o,...this.screenData}}async getBody(t){if(!t?.data?.list?.length)return!1;let e=[];for(let s of t?.data?.list)e.push({cnt:1*s.num,id:1*s.id});return{list:e}}async computes(t){let e=await this.mysApi.getData("blueprintCompute",{body:t});return!(!e||0!==e.retcode)&&(e=e.data?.list,e)}}export{i as default};
